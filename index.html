<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PiXiEEDraw</title>
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>
  <body>
    <div class="app-stage">
      <div class="canvas-wrapper">
        <div class="canvas-stage" id="canvasStage">
          <canvas id="pixelCanvas" width="32" height="32"></canvas>
        </div>
        <canvas id="previewCanvas" width="32" height="32" aria-hidden="true"></canvas>
      </div>

      <div
        class="floating-dock"
        id="floatingDock"
        role="toolbar"
        aria-label="ツール操作"
        data-collapsed="false"
        style="top: 24px; left: 24px"
      >
        <div class="floating-dock__bar">
          <button
            class="floating-dock__toggle"
            type="button"
            id="dockToggle"
            aria-label="ドックを折りたたむ"
            aria-expanded="true"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M7 8.5L12 13.5L17 8.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <span class="sr-only">ドックの表示を切り替え</span>
          </button>
          <span class="app-title">PiXiEEDraw</span>
          <button
            class="floating-dock__handle"
            type="button"
            id="dockHandle"
            aria-label="ツールボタンを移動"
          >
            <span aria-hidden="true">⋮⋮</span>
          </button>
        </div>
        <div class="floating-dock__content">
          <div class="floating-dock__group floating-dock__group--mini-toggles">
            <button class="dock-icon-button" type="button" data-dock-toggle="toolDock" aria-pressed="true" aria-label="ツールボックス表示">
              <img src="assets/icons/menu-tools.png" alt="ツールボックス" width="28" height="28" />
              <span class="sr-only">ツールボックス表示</span>
            </button>
            <button
              class="dock-icon-button"
              type="button"
              data-dock-toggle="paletteDock"
              aria-pressed="true"
              aria-label="カラーパレット表示"
            >
              <img src="assets/icons/menu-palette.png" alt="カラーパレット" width="28" height="28" />
              <span class="sr-only">カラーパレット表示</span>
            </button>
            <button
              class="dock-icon-button"
              type="button"
              data-dock-toggle="canvasDock"
              aria-pressed="true"
              aria-label="キャンバス設定表示"
            >
              <img src="assets/icons/menu-canvas.png" alt="キャンバス設定" width="28" height="28" />
              <span class="sr-only">キャンバス設定表示</span>
            </button>
          </div>
          <div class="floating-dock__group floating-dock__group--actions">
            <button
              id="exportImage"
              class="dock-icon-button"
              type="button"
              data-panel-target="exportPanel"
              aria-expanded="false"
              aria-label="PNG書き出し"
            >
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 3V15" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M5 19H19" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              </svg>
              <span class="sr-only">PNG書き出し</span>
            </button>
            <button id="clearCanvas" class="dock-icon-button dock-icon-button--danger" type="button" aria-label="全消去">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 7H18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
                <path d="M9 7V5.5C9 4.67157 9.67157 4 10.5 4H13.5C14.3284 4 15 4.67157 15 5.5V7" stroke="currentColor" stroke-width="1.6" />
                <path d="M8.5 11L15.5 18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
                <path d="M15.5 11L8.5 18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              </svg>
              <span class="sr-only">全消去</span>
            </button>
          </div>
        </div>
      </div>

      <div class="mini-dock mini-dock--tools" id="toolDock" data-visible="true" data-state="expanded" style="top: 160px; left: 24px">
        <div class="mini-dock__drag" id="toolDockDrag" aria-hidden="true" title="ドラッグで移動">
          <span class="mini-dock__drag-line"></span>
        </div>
        <div class="mini-dock__header">
          <div class="mini-dock__status" aria-hidden="true">
            <span class="mini-dock__status-icon">
              <img id="toolDockStatus" src="assets/icons/tool-pen.png" alt="選択中のツール" width="22" height="22" />
            </span>
          </div>
          <button class="mini-dock__state" type="button" data-dock-state="toolDock" aria-label="ツールボックスをコンパクト表示">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path class="mini-dock__state-line mini-dock__state-line--horizontal" d="M6 12H18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              <path class="mini-dock__state-line mini-dock__state-line--vertical" d="M12 6V18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="mini-dock__body">
          <div class="mini-dock__grid mini-dock__grid--tools" role="group" aria-label="描画ツール">
            <button class="mini-button tool-button tool-button--active" type="button" data-tool="pen" data-icon="assets/icons/tool-pen.png" aria-label="ペン">
              <img src="assets/icons/tool-pen.png" alt="ペン" width="32" height="32" />
            </button>
            <button class="mini-button tool-button" type="button" data-tool="eraser" data-icon="assets/icons/tool-eraser.png" aria-label="消しゴム">
              <img src="assets/icons/tool-eraser.png" alt="消しゴム" width="32" height="32" />
            </button>
            <button class="mini-button tool-button" type="button" data-tool="fill" data-icon="assets/icons/tool-fill.png" aria-label="塗りつぶし">
              <img src="assets/icons/tool-fill.png" alt="塗りつぶし" width="32" height="32" />
            </button>
            <button class="mini-button tool-button" type="button" data-tool="eyedropper" data-icon="assets/icons/tool-eyedropper.png" aria-label="スポイト">
              <img src="assets/icons/tool-eyedropper.png" alt="スポイト" width="32" height="32" />
            </button>
            <button class="mini-button tool-button" type="button" data-toggle="virtualCursor" data-icon="assets/icons/tool-cursor.png" aria-label="仮想カーソル">
              <img src="assets/icons/tool-cursor.png" alt="仮想カーソル" width="32" height="32" />
            </button>
          </div>
        <div class="mini-dock__form mini-dock__form--brush">
          <label class="mini-field mini-field--inline">
            <span>ブラシ</span>
            <input id="brushSize" type="range" min="1" max="8" value="1" />
            <span id="brushSizeDisplay" class="mini-value">1</span>
          </label>
        </div>
        </div>
      </div>

      <div class="mini-dock mini-dock--palette" id="paletteDock" data-visible="true" data-state="expanded" style="top: 160px; right: 24px">
        <div class="mini-dock__drag" id="paletteDockDrag" aria-hidden="true" title="ドラッグで移動">
          <span class="mini-dock__drag-line"></span>
        </div>
        <div class="mini-dock__header">
          <div class="mini-dock__status" aria-hidden="true">
            <span class="mini-dock__status-color" id="paletteDockStatus" style="background-color: #58c4ff"></span>
          </div>
          <button class="mini-dock__state" type="button" data-dock-state="paletteDock" aria-label="カラーパレットをコンパクト表示">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path class="mini-dock__state-line mini-dock__state-line--horizontal" d="M6 12H18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              <path class="mini-dock__state-line mini-dock__state-line--vertical" d="M12 6V18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="mini-dock__body">
          <div class="mini-dock__grid mini-dock__grid--palette swatch-grid" id="palette" role="grid" aria-label="カラーパレット"></div>
        </div>
      </div>

      <div class="mini-dock mini-dock--canvas" id="canvasDock" data-visible="true" data-state="expanded" style="top: 320px; left: 24px">
        <div class="mini-dock__drag" id="canvasDockDrag" aria-hidden="true" title="ドラッグで移動">
          <span class="mini-dock__drag-line"></span>
        </div>
        <div class="mini-dock__header">
          <div class="mini-dock__status" aria-hidden="true">
            <span class="mini-dock__status-text" id="canvasDockStatus">32×32</span>
          </div>
          <button class="mini-dock__state" type="button" data-dock-state="canvasDock" aria-label="キャンバス設定をコンパクト表示">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path class="mini-dock__state-line mini-dock__state-line--horizontal" d="M6 12H18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              <path class="mini-dock__state-line mini-dock__state-line--vertical" d="M12 6V18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="mini-dock__body">
        <div class="mini-dock__form" aria-label="キャンバス設定">
          <input id="pixelSize" type="hidden" value="20" />
          <label class="mini-field">
            <span>横幅</span>
            <input id="canvasWidth" type="number" value="32" min="8" max="128" />
          </label>
          <label class="mini-field">
            <span>縦幅</span>
            <input id="canvasHeight" type="number" value="32" min="8" max="128" />
          </label>
          <button id="resizeCanvas" class="mini-dock__apply" type="button">サイズ反映</button>
        </div>
        </div>
      </div>

      <footer class="app-footer">
        <small>© 2025 アルタ</small>
      </footer>
    </div>

    <div class="status-hud" role="status" aria-live="polite">
      <span class="workspace-info" id="cursorInfo">カーソル: -- , --</span>
      <span class="workspace-info" id="layerInfo">ドット数: 0</span>
    </div>

    <div class="panel-overlay" id="panelOverlay" hidden></div>

    <div class="floating-panel" id="exportPanel" role="dialog" aria-modal="true" aria-labelledby="exportPanelTitle" hidden>
      <div class="floating-panel__header">
        <h2 id="exportPanelTitle">PNG 書き出し</h2>
        <button class="floating-panel__close" type="button" data-panel-close aria-label="閉じる">×</button>
      </div>
      <div class="floating-panel__body">
        <div class="panel-section panel-section--floating">
          <h3>出力サイズ</h3>
          <label class="field">
            <span>解像度</span>
            <select id="exportSize" class="input-select"></select>
          </label>
          <small class="field-help" id="exportHint">最大解像度は 1024px までです。</small>
        </div>
        <button id="confirmExport" class="button button--block" type="button">PNG を保存</button>
      </div>
    </div>

    <script src="assets/js/app.js" defer></script>
  </body>
</html>
